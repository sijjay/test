name: Azure CLI Key Vault Access

on:
  workflow_dispatch:  # Allows manual trigger

jobs:
  azure-auth:
    runs-on: ubuntu-latest
    steps:

      - name: Azure login
        uses: azure/login@v2
        with:
          client-id: 4722d169-f7d5-44f6-88d4-bfd24adce7f8
          tenant-id: 0e7f6f8b-dfc2-4a5d-9c14-6f3eb7a8fe8d
          subscription-id: 570d31df-cdb1-4474-85d1-026976153e7e
          auth-type: IDENTITY

      - name: Fetch secrets from Azure Key Vault
        run: |
          SECRET_VALUE=$(az keyvault secret show --name "pilot-test-secret" --vault-name "pilot-kv-main" --query "value" -o tsv)
          echo "Fetched secret successfully."
